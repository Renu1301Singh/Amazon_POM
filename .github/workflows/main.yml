name: Install Chrome Browser

on:
  push:
    branches:
      - main

jobs:
  chrome-install:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout Repository
      uses: actions/checkout@v2

    - name: Install Chrome Browser
      run: |
        # Update the package list
        sudo apt-get update

        # Install the prerequisites
        sudo apt-get install -y gdebi-core

        # Download the Chrome Browser
        wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb

        # Install the Chrome Browser
        sudo gdebi google-chrome-stable_current_amd64.deb -q

    - name: Verify Chrome Browser Installation
      run: |
        # Check if Chrome Browser is installed
        chrome --version

        # Check if Chrome Browser can be launched
        google-chrome --no-sandbox
      

    - name: Cache Maven packages
      uses: actions/cache@v2
      with:
          path: ~/.m2
          key: ${{ runner.os }}-maven-${{ hashFiles('**/pom.xml') }}
          restore-keys: ${{ runner.os }}-maven-

    - name: Build and test
      run: mvn clean test -Dwebdriver.chrome.driver=/usr/local/bin/chromedriver 
